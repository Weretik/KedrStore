@page "/information"
@rendermode InteractiveServer

<MudTabs Elevation="2" Rounded="true" PanelClass="pa-6" ApplyEffectsToContainer="true"
         @bind-ActivePanelIndex="Index">

    <MudTabPanel Text="Доставка" Icon="@Icons.Material.Filled.LocalShipping">
        <Delivery></Delivery>
    </MudTabPanel>
    <MudTabPanel Text="Оплата" Icon="@Icons.Material.Filled.Payment">
        <Payment></Payment>
    </MudTabPanel>
    <MudTabPanel Text="Повернення" Icon="@Icons.Material.Filled.AssignmentReturn">
        <Returns></Returns>
    </MudTabPanel>
    <MudTabPanel Text="Гарантія" Icon="@Icons.Material.Filled.VerifiedUser">
        <Warranty></Warranty>
    </MudTabPanel>

</MudTabs>

@code {
    [SupplyParameterFromQuery(Name = "tab")]
    private string? Tab { get; set; }

    private int _index;
    private int Index
    {
        get => _index;
        set
        {
            if (_index == value) return;
            _index = value;

            var newTab = value switch
            {
                0 => "shipping",
                1 => "payment",
                2 => "returns",
                3 => "warranty",
                _ => "shipping"
            };
            if (!string.Equals(Tab, newTab, StringComparison.OrdinalIgnoreCase))
                Nav.NavigateTo($"/information?tab={newTab}", forceLoad: false);
        }
    }

    protected override void OnParametersSet()
    {
        _index = (Tab ?? "shipping").ToLowerInvariant() switch
        {
            "shipping" => 0,
            "payment"  => 1,
            "returns"  => 2,
            "warranty" => 3,
            _ => 0
        };
    }
}
